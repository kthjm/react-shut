!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("atra")):"function"==typeof define&&define.amd?define(["exports","react","atra"],e):e(t.ReactShut={},t.React,t.Atra)}(this,function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(){return Date.now()},s=function(){function t(){r(this,t)}return i(t,[{key:"active",value:function(){return Boolean(this.state)&&"object"===o(this.state)}},{key:"init",value:function(t){this.state={now:a(),x:t.pageX,y:t.pageY,doneCheckScroll:!1,settle:void 0}}},{key:"notScroll",value:function(t){if(!this.state.doneCheckScroll){var e=t-this.state.y;if(e>10||e<-10)return this.kill();this.state.doneCheckScroll=!0}return!0}},{key:"setX",value:function(t){this.state.x=t}},{key:"getX",value:function(){return this.state.x}},{key:"setY",value:function(t){this.state.y=t}},{key:"getY",value:function(){return this.state.y}},{key:"setSettle",value:function(t){this.state.settle=t}},{key:"getSettle",value:function(){var t=this.state.settle;return a()-this.getNow()<26&&"function"==typeof t&&t}},{key:"setNow",value:function(){this.state.now=a()}},{key:"getNow",value:function(){return this.state.now}},{key:"kill",value:function(){this.state=null}}]),t}(),c="rgb(251, 251, 251)",f=function(){return window.innerWidth},l=function(){return window.innerHeight},p=function(t){return"function"==typeof t},h=function(t,e){return function(n){if(n&&!t.rootSize){var o=function(){return n[e]};t.rootSize=o}}},v=function(t,e){return function(){var n=t.pre;if(n.active()){(n.getSettle()||(e()?t.quit:t.come))(),n.kill()}}},d=function(t,e){return function(n){if(n.currentTarget,n.target===n.currentTarget){var o=n.currentTarget.style.transform===e?t.props.onComeEnd:t.props.onQuitEnd;return o&&p(o)&&o(n)}}},S=function(t){return function(n){function o(e){r(this,o);var n=u(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e)),i=t(n);return n.nowRootSize=i.firstRootSize,n.state={value:e.mountWithShut?n.nowRootSize:0},n.pre=new s,n.come=function(){return n.setState({value:0})},n.quit=i.quit,n.canInit=i.canInit,n.a=y({ref:i.rootRef,onTouchStart:function(t){var e=t.touches;return n.canInit(e)&&n.pre.init(e[0])},onTouchMove:i.onTouchMove,onTouchEnd:i.onTouchEnd,onTransitionEnd:i.onTransitionEnd}),n.renders={transform:i.transform,transitionDuration:i.transitionDuration,background:function(){return n.props.background||c},overflowY:function(){return n.props.notScroll||0!==n.state.value?"hidden":"scroll"}},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,e.Component),i(o,[{key:"render",value:function(){var t=this.a,n=this.renders.transform(),o=this.renders.transitionDuration(),r=this.renders.background(),i=this.renders.overflowY();return e.createElement("div",t("ROOT"),e.createElement("div",t("MOVE",{style:{transform:n,transitionDuration:o,background:r}}),e.createElement("div",t("WRAP",{style:{overflowY:i}}),this.props.children),this.createQuit()))}},{key:"componentDidMount",value:function(){return this.nowRootSize=this.rootSize(),this.props.mountWithShut&&function(t){return window.requestAnimationFrame(t)}(this.come)}},{key:"componentDidUpdate",value:function(){var t=this.rootSize();t!==this.nowRootSize&&(this.nowRootSize=t)}},{key:"createQuit",value:function(){var t=this.props.Quit;return t&&p(t)&&e.createElement(t,{fn:this.quit})}}]),o}()},y=function(t){var e=t.ref,o=t.onTouchStart,r=t.onTouchMove,i=t.onTouchEnd,u=t.onTransitionEnd;return n({ROOT:{ref:e,onTouchStart:o,onTouchMove:r,onTouchEnd:i,style:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"hidden"}},MOVE:{onTransitionEnd:u,style:{width:"100%",height:"100%",transitionProperty:"transform"}},WRAP:{style:{height:"100%",overflowScrolling:"touch",WebkitOverflowScrolling:"touch"}}})},g=S(function(t){return{firstRootSize:l(),rootRef:h(t,"clientHeight"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=l()*n;return 1===e.length&&e[0].pageY<o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active()){var r=t.state.value,i=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(i<0?t.come:t.quit),o.setNow();var u=r+i;return u>0?t.setState({value:u}):0!==r&&t.come()}},onTouchEnd:v(t,function(){var e=t.nowRootSize;return t.state.value>e*(t.props.quitRatio||.6)}),onTransitionEnd:d(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(t.props.duration||.4)+"s"}}}),m=S(function(t){return{firstRootSize:-f(),rootRef:h(t,"clientWidth"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=f()*(1-n);return 1===e.length&&e[0].pageX>o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active()&&o.notScroll(n.pageY)){var r=t.state.value,i=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(i<0?t.quit:t.come),o.setNow();var u=r+i;return u<0?t.setState({value:u}):0!==r&&t.come()}},onTouchEnd:v(t,function(){var e=t.nowRootSize;return t.state.value<-e*(t.props.quitRatio||.6)}),onTransitionEnd:d(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(t.props.duration||.4)+"s"}}}),w=S(function(t){return{firstRootSize:f(),rootRef:h(t,"clientWidth"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=f()*n;return 1===e.length&&e[0].pageX<o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active()&&o.notScroll(n.pageY)){var r=t.state.value,i=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(i<0?t.come:t.quit),o.setNow();var u=r+i;return u>0?t.setState({value:u}):0!==r&&t.come()}},onTouchEnd:v(t,function(){var e=t.nowRootSize;return t.state.value>e*(t.props.quitRatio||.6)}),onTransitionEnd:d(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(t.props.duration||.4)+"s"}}}),R=S(function(t){return{firstRootSize:-l(),rootRef:h(t,"clientHeight"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=l()*(1-n);return 1===e.length&&e[0].pageY>o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active()){var r=t.state.value,i=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(i<0?t.quit:t.come),o.setNow();var u=r+i;return u<0?t.setState({value:u}):0!==r&&t.come()}},onTouchEnd:v(t,function(){var e=t.nowRootSize;return t.state.value<-e*(t.props.quitRatio||.6)}),onTransitionEnd:d(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(t.props.duration||.4)+"s"}}});t.ShutFromBottom=g,t.ShutFromLeft=m,t.ShutFromRight=w,t.ShutFromTop=R,Object.defineProperty(t,"__esModule",{value:!0})});
