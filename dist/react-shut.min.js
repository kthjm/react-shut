!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("atra")):"function"==typeof define&&define.amd?define(["exports","react","atra"],e):e(t.ReactShut={},t.React,t.Atra)}(this,function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var o="rgb(251, 251, 251)",r=function(t){return"function"==typeof t},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},c=function(){return Date.now()},f=function(){function t(){i(this,t)}return a(t,[{key:"init",value:function(t){this.state={now:c(),x:t.pageX,y:t.pageY,doneCheckScroll:!1,settle:void 0}}},{key:"canMove",value:function(){return Boolean(this.state)&&"object"===u(this.state)}},{key:"notScroll",value:function(t){if(!this.state.doneCheckScroll){var e=t-this.state.y;if(e>10||e<-10)return this.kill();this.state.doneCheckScroll=!0}return!0}},{key:"canEnd",value:function(){return this.canMove()&&r(this.state.settle)}},{key:"setX",value:function(t){this.state.x=t}},{key:"getX",value:function(){return this.state.x}},{key:"setY",value:function(t){this.state.y=t}},{key:"getY",value:function(){return this.state.y}},{key:"setSettle",value:function(t){this.state.settle=t}},{key:"getSettle",value:function(){var t=this.state.settle;return c()-this.getNow()<26&&"function"==typeof t&&t}},{key:"setNow",value:function(){this.state.now=c()}},{key:"getNow",value:function(){return this.state.now}},{key:"kill",value:function(){this.state=null}}]),t}(),l=function(t){return function(n){function u(e){i(this,u);var n=s(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e)),r=t(n);return n.nowRootSize=r.firstRootSize,n.pre=new f,n.state={value:e.mountWithShut?n.nowRootSize:0},n.come=function(){return n.setState({value:0})},n.quit=r.quit,n.canInit=r.canInit,n.a=p({ref:r.rootRef,onTouchStartCapture:function(t){var e=t.touches;return n.canInit(e)&&n.pre.init(e[0])},onTouchMoveCapture:r.onTouchMoveCapture,onTouchEndCapture:r.onTouchEndCapture,onTransitionEnd:r.onTransitionEnd}),n.renderValues=function(){return{transform:r.transform(),transitionDuration:r.transitionDuration(),background:n.props.background||o,overflowY:n.props.notScroll||0!==n.state.value?"hidden":"scroll"}},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,e.Component),a(u,[{key:"render",value:function(){var t=this.a,n=(0,this.renderValues)(),o=n.transform,r=n.transitionDuration,u=n.background,i=n.overflowY;return e.createElement("div",t("ROOT"),e.createElement("div",t("MOVE",{style:{transform:o,transitionDuration:r,background:u}}),e.createElement("div",t("WRAP",{style:{overflowY:i}}),this.props.children),this.createQuit()))}},{key:"setRootSize",value:function(){this.nowRootSize=this.getRootSize()}},{key:"componentDidMount",value:function(){return this.setRootSize(),this.props.mountWithShut&&function(t){return window.requestAnimationFrame(t)}(this.come)}},{key:"componentDidUpdate",value:function(){this.setRootSize()}},{key:"createQuit",value:function(){var t=this.props.Quit;return t&&r(t)&&e.createElement(t,{fn:this.quit})}}]),u}()},p=function(t){var e=t.ref,o=t.onTouchStartCapture,r=t.onTouchMoveCapture,u=t.onTouchEndCapture,i=t.onTransitionEnd;return n({ROOT:{ref:e,onTouchStartCapture:o,onTouchMoveCapture:r,onTouchEndCapture:u,style:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"hidden"}},MOVE:{onTransitionEnd:i,style:{width:"100%",height:"100%",transitionProperty:"transform"}},WRAP:{style:{height:"100%",overflowScrolling:"touch",WebkitOverflowScrolling:"touch"}}})},v=function(){return window.innerWidth},h=function(){return window.innerHeight},d=function(t){return"number"==typeof t},S=function(t,e){return function(n){if(n){var o=function(){return n[e]};t.getRootSize=o}}},y=function(t,e){return function(n){var o=t.pre;if(o.canEnd()){n.stopPropagation(),n.preventDefault();(o.getSettle()||(e()?t.quit:t.come))(),o.kill()}}},g=function(t,e){return function(n){if(n.target===n.currentTarget){var o=(n.currentTarget||n.target).style.transform===e?t.props.onComeEnd:t.props.onQuitEnd;o&&r(o)&&o(n)}}},m=l(function(t){return{firstRootSize:-h(),rootRef:S(t,"clientHeight"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio,o=d(n)?n:.4,r=h()*(1-o);return 1===e.length&&e[0].pageY>r},onTouchMoveCapture:function(e){var n=e.touches[0],o=t.pre;if(o.canMove()){var r=t.state.value,u=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(u<0?t.quit:t.come),o.setNow();var i=r+u;return i<0?t.setState({value:i}):0!==r&&t.come()}},onTouchEndCapture:y(t,function(){var e=t.nowRootSize,n=t.state.value,o=t.props.quitRatio;return n<-e*(d(o)?o:.6)}),onTransitionEnd:g(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(d(t.props.duration)?t.props.duration:.4)+"s"}}}),w=l(function(t){return{firstRootSize:h(),rootRef:S(t,"clientHeight"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio,o=d(n)?n:.4,r=h()*o;return 1===e.length&&e[0].pageY<r},onTouchMoveCapture:function(e){var n=e.touches[0],o=t.pre;if(o.canMove()){var r=t.state.value,u=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(u<0?t.come:t.quit),o.setNow();var i=r+u;return i>0?t.setState({value:i}):0!==r&&t.come()}},onTouchEndCapture:y(t,function(){var e=t.nowRootSize,n=t.state.value,o=t.props.quitRatio;return n>e*(d(o)?o:.6)}),onTransitionEnd:g(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(d(t.props.duration)?t.props.duration:.4)+"s"}}}),R=l(function(t){return{firstRootSize:-v(),rootRef:S(t,"clientWidth"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio,o=d(n)?n:.4,r=v()*(1-o);return 1===e.length&&e[0].pageX>r},onTouchMoveCapture:function(e){var n=e.touches[0],o=t.pre;if(o.canMove()&&o.notScroll(n.pageY)){var r=t.state.value,u=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(u<0?t.quit:t.come),o.setNow();var i=r+u;return i<0?t.setState({value:i}):0!==r&&t.come()}},onTouchEndCapture:y(t,function(){var e=t.nowRootSize,n=t.state.value,o=t.props.quitRatio;return n<-e*(d(o)?o:.6)}),onTransitionEnd:g(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(d(t.props.duration)?t.props.duration:.4)+"s"}}}),b=l(function(t){return{firstRootSize:v(),rootRef:S(t,"clientWidth"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio,o=d(n)?n:.4,r=v()*o;return 1===e.length&&e[0].pageX<r},onTouchMoveCapture:function(e){var n=e.touches[0],o=t.pre;if(o.canMove()&&o.notScroll(n.pageY)){var r=t.state.value,u=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(u<0?t.come:t.quit),o.setNow();var i=r+u;return i>0?t.setState({value:i}):0!==r&&t.come()}},onTouchEndCapture:y(t,function(){var e=t.nowRootSize,n=t.state.value,o=t.props.quitRatio;return n>e*(d(o)?o:.6)}),onTransitionEnd:g(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(d(t.props.duration)?t.props.duration:.4)+"s"}}});t.ShutFromTop=m,t.ShutFromBottom=w,t.ShutFromLeft=R,t.ShutFromRight=b,Object.defineProperty(t,"__esModule",{value:!0})});
