!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("atra")):"function"==typeof define&&define.amd?define(["exports","react","atra"],e):e(t.ReactShut={},t.React,t.Atra)}(this,function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(){function t(){o(this,t),this.active=!1}return r(t,[{key:"init",value:function(t){this.state={now:Date.now(),x:t.pageX,y:t.pageY,doneCheckScroll:!1,settle:void 0},this.active=!0}},{key:"isScroll",value:function(t){if(!this.state.doneCheckScroll){var e=t-this.state.y;if(e>10||e<-10)return this.kill(),!0;this.state.doneCheckScroll=!0}}},{key:"setX",value:function(t){this.state.x=t}},{key:"getX",value:function(){return this.state.x}},{key:"setY",value:function(t){this.state.y=t}},{key:"getY",value:function(){return this.state.y}},{key:"setSettle",value:function(t){this.state.settle=t}},{key:"getSettle",value:function(){return this.state.settle}},{key:"setNow",value:function(){this.state.now=Date.now()}},{key:"getNow",value:function(){return this.state.now}},{key:"kill",value:function(){this.state=null,this.active=!1}}]),t}(),u="0.4s",s=function(t){return"function"==typeof t},c=function(t,e){return function(n){n&&!t.rootSize&&(t.rootSize=function(){return n[e]})}},l=function(t,e){return function(){if(t.pre.active){var n=t.pre;t.nowRootSize,t.props.quitRatio,t.state.value;(Date.now()-n.getNow()<26?n.getSettle():e()?t.quit:t.come)(),n.kill()}}},f=function(t,e){return function(n){if(n.target===n.currentTarget){var o=n.currentTarget.style.transform===e?t.props.onCome:t.props.onQuit;return s(o)&&o(n)}}},h=function(t){return function(n){function u(e){o(this,u);var n=i(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e)),r=t(n);return n.nowRootSize=r.firstRootSize,n.state={value:e.mountWithShut?n.nowRootSize:0},n.pre=new a,n.rootRef=r.rootRef,n.come=function(){return n.setState({value:0})},n.quit=r.quit,n.canInit=r.canInit,n.listeners={},n.listeners.onTouchStart=function(t){var e=t.touches;return n.canInit(e)&&n.pre.init(e[0])},n.listeners.onTouchMove=r.onTouchMove,n.listeners.onTouchEnd=r.onTouchEnd,n.listeners.onTransitionEnd=r.onTransitionEnd,n.renders={},n.renders.transform=r.transform,n.renders.transitionDuration=r.transitionDuration,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,e.Component),r(u,[{key:"render",value:function(){var t=this.rootRef,n=this.listeners,o=n.onTouchStart,r=n.onTouchMove,i=n.onTouchEnd,a=n.onTransitionEnd,u=this.props.background||"rgb(251, 251, 251)",s=this.renders.transform(),c=this.renders.transitionDuration(),l=0===this.state.value?"scroll":"hidden";return e.createElement("div",p("ROOT",{ref:t,onTouchStart:o,onTouchMove:r,onTouchEnd:i}),e.createElement("div",p("MOVE",{onTransitionEnd:a,style:{background:u,transform:s,transitionDuration:c}}),e.createElement("div",p("WRAP",{style:{overflowY:l}}),this.props.children),this.createQuit()))}},{key:"componentDidMount",value:function(){return this.nowRootSize=this.rootSize(),this.props.mountWithShut&&requestAnimationFrame(this.come)}},{key:"componentDidUpdate",value:function(){var t=this.rootSize();t!==this.nowRootSize&&(this.nowRootSize=t)}},{key:"createQuit",value:function(){var t=this.props.Quit;return s(t)&&e.createElement(t,{fn:this.quit})}}]),u}()},p=n({ROOT:{style:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"hidden"}},MOVE:{style:{width:"100%",height:"100%",transitionProperty:"transform"}},WRAP:{style:{height:"100%",overflowScrolling:"touch",WebkitOverflowScrolling:"touch"}}}),v=h(function(t){return{firstRootSize:window.innerHeight,rootRef:c(t,"clientHeight"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=window.innerHeight*n;return 1===e.length&&e[0].pageY<o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active){var r=t.state.value,i=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(i<0?t.come:t.quit),o.setNow();var a=r+i;return a>0?t.setState({value:a}):0!==r&&t.come()}},onTouchEnd:l(t,function(){var e=t.nowRootSize;return t.state.value>e*(t.props.quitRatio||.6)}),onTransitionEnd:f(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(t.props.duration||u)}}}),d=h(function(t){return{firstRootSize:-window.innerWidth,rootRef:c(t,"clientWidth"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=window.innerWidth*(1-n);return 1===e.length&&e[0].pageX>o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active&&!o.isScroll(n.pageY)){var r=t.state.value,i=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(i<0?t.quit:t.come),o.setNow();var a=r+i;return a<0?t.setState({value:a}):0!==r&&t.come()}},onTouchEnd:l(t,function(){var e=t.nowRootSize;return t.state.value<-e*(t.props.quitRatio||.6)}),onTransitionEnd:f(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(t.props.duration||u)}}}),S=h(function(t){return{firstRootSize:window.innerWidth,rootRef:c(t,"clientWidth"),quit:function(){return t.setState({value:t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=t.nowRootSize*n;return 1===e.length&&e[0].pageX<o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active&&!o.isScroll(n.pageY)){var r=t.state.value,i=n.pageX-o.getX();o.setX(n.pageX),o.setSettle(i<0?t.come:t.quit),o.setNow();var a=r+i;return a>0?t.setState({value:a}):0!==r&&t.come()}},onTouchEnd:l(t,function(){var e=t.nowRootSize;return t.state.value>e*(t.props.quitRatio||.6)}),onTransitionEnd:f(t,"translateX(0px)"),transform:function(){return"translateX("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===t.nowRootSize)&&(t.props.duration||u)}}}),w=h(function(t){return{firstRootSize:-window.innerHeight,rootRef:c(t,"clientHeight"),quit:function(){return t.setState({value:-t.nowRootSize})},canInit:function(e){var n=t.props.touchRatio||.4,o=window.innerHeight*(1-n);return 1===e.length&&e[0].pageY>o},onTouchMove:function(e){var n=e.touches[0],o=t.pre;if(o.active){var r=t.state.value,i=n.pageY-o.getY();o.setY(n.pageY),o.setSettle(i<0?t.quit:t.come),o.setNow();var a=r+i;return a<0?t.setState({value:a}):0!==r&&t.come()}},onTouchEnd:l(t,function(){var e=t.nowRootSize;return t.state.value<-e*(t.props.quitRatio||.6)}),onTransitionEnd:f(t,"translateY(0px)"),transform:function(){return"translateY("+t.state.value+"px)"},transitionDuration:function(){return(0===t.state.value||t.state.value===-t.nowRootSize)&&(t.props.duration||u)}}});t.ShutFromBottom=v,t.ShutFromLeft=d,t.ShutFromRight=S,t.ShutFromTop=w,Object.defineProperty(t,"__esModule",{value:!0})});
